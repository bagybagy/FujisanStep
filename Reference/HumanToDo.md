# 運用マニュアル (HumanToDo)

## 概要
本アプリは学校の校舎ビルでの半年間の運用を想定しています。
ブラウザのLocalStorageを使用しているため、ユーザーのデータ消失リスクがあります。
本ドキュメントでは、データ消失時の対応や管理者による運用フローを定めます。

## 1. データ消失時の対応（救済フロー）

ユーザーから「データが消えた（スマホを変えた、履歴を消した）」と申告があった場合、以下の手順で復旧をサポートします。

### オプションA: 管理者画面からの直接付与
1. 管理者画面を開く。
2. ユーザー一覧から該当ユーザー（または新規ユーザー）を探す。※新規の場合は一度QRを読んで名前登録してもらう必要があるかも。
3. 「段数修正」機能を使用し、本人の申告または記録に基づいて段数を設定する。

### オプションB: 救済用QRコードの提示
管理者が予め「ボーナス用QRコード」を用意しておきます。
- 例: 「一気に1000段増えるQRコード（管理者のみ所持）」
- ※ ただし、これだと「1000段」刻みでしか復旧できないため、オプションAの管理画面実装を推奨します。

### 運用ルール案
- **自己申告制**: 厳密なログ確認はコスト高なので、基本的に「自己申告」を信じて復旧させる。
- **リセット祭り**: もし運用が煩雑になった場合、学期ごとに「シーズンリセット」を行い、全員ゼロから再スタートするイベントにするのも手です。

## 2. 定期メンテナンス

### ユーザーデータの確認
- 管理者画面で「明らかに異常な数値（1日で富士山往復など）」のユーザーがいないか確認。
- 300人を超えて表示が重くなりすぎている場合、管理者画面から「最終ログインが1ヶ月以上のユーザー」を削除（非表示化）する等の整理を行う。

## 3. トラブルシューティング

### Q. QRコードを読んでも反応しない
- A. ブラウザのカメラ権限を確認してください。
- A. 「1日1回制限」に引っかかっている可能性があります（本日すでに記録済み）。

### Q. ランキングに名前が出ない
- A. 名前登録（初回モーダル）をスキップしていませんか？ アプリ内の設定（実装予定）から名前を登録してください。
- A. オフラインになっている可能性があります。

## 4. 管理者画面へのアクセス
- アプリURLの末尾に `?mode=admin` を付けてアクセス（または特定の隠しコマンド）。
- ※ 簡易的なパスワード保護を実装予定。

## 5. QRコードの作成方法

### URLフォーマット
```
https://[ホスティングURL]/?id=[場所ID]&steps=[段数]
```

**パラメータ説明**:
| パラメータ | 説明 | 例 |
|-----------|------|-----|
| `id` | 場所を識別するユニークなID（英数字推奨） | `floor_7`, `stair_A`, `rooftop` |
| `steps` | その階段を上った時に加算される段数 | `50`, `100`, `200` |

### 例
- 7階階段（50段）: `https://username.github.io/FujisanStep/?id=floor_7&steps=50`
- 屋上階段（100段）: `https://username.github.io/FujisanStep/?id=rooftop&steps=100`
- 特別イベント（500段）: `https://username.github.io/FujisanStep/?id=event_2026&steps=500`

### QRコード生成手順
1. **無料QRコード生成サイト**を使用（推奨: [QRのススメ](https://qr.quel.jp/)、[バーコードどころ](https://barcode-place.azurewebsites.net/)）
2. 上記フォーマットのURLを入力
3. QRコードを生成・ダウンロード
4. 印刷して各階段に設置

### 注意事項
- **1日1回制限**: 1日に1回のみカウントされます（場所に関わらず、翌日0時にリセット）
- **3秒クールタイム**: QR読み取り後、次の読み取りまで3秒の待機時間があります
- **場所IDの一意性**: 同じIDが複数の場所に存在しないよう管理してください
