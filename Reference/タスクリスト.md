# 開発タスクリスト

## フェーズ1: 基本機能（完了）
- [x] 1. 基本HTML構造の作成（モバイルファースト）
- [x] 2. LocalStorageとの連携ロジック（データの取得・保存）の実装
- [x] 3. URLパラメータのパース機能の実装
- [x] 4. 重複読み取り防止ロジックの実装（IDチェック & 3秒クールタイム）
- [x] 5. 標高計算および進捗表示の実装
- [x] 6. 現在の合目（1/5/8/頂上）判定とバッジ表示の実装
- [x] 7. 直近の読み取り履歴（ログ）表示の実装
- [x] 8. デバッグ用ツール（データをリセットするボタン）の作成

## フェーズ2: バックエンド・リアルタイム機能（完了）
- [x] 9. Supabaseのセットアップと接続テスト
- [x] 10. ユーザー名設定機能（初回起動時モーダル、スキップ可能）の実装
- [x] 11. 全ユーザーの現在地をリアルタイム取得・同期するロジックの実装（Presence）
- [x] 12. climbers テーブルへのデータ永続化（upsert）

## フェーズ3: ビジュアル演出（完了）
- [x] 13. 標高に応じた背景色アニメーションの実装（動的グラデーション）
- [x] 14. 成功時のバイブレーションと通知音の実装
- [x] 15. 各合目到達時の「お祝い演出」の実装（紙吹雪アニメーション）
- [x] 16. トースト通知システムの実装（画面上部に固定表示）

## フェーズ4: 垂直登山ルートの実装（完了）
- [x] 17. 横向きプログレスバーから縦向き登山ルートへの変換
- [x] 18. 山のグラデーション背景の実装（緑→青→灰→白）
- [x] 19. 合目マーカーの自動配置（スタート、1合目、5合目、8合目、山頂）
- [x] 20. 登山者アバターの個性化
  - [x] ユーザー名からハッシュで色を自動生成
  - [x] 名前の1文字目を円形アバターに表示
  - [x] 自分のアバターを特別表示（ゴールド枠 + ★マーク）
- [x] 21. ツールチップの実装（ホバー/タップで名前と標高を表示）
- [x] 22. スムーズなアニメーション（CSS transition、0.8秒）

## フェーズ5: データアーキテクチャのリファクタリング（完了）
- [x] 23. データ取得元をPresenceからclimbersテーブルに変更
- [x] 24. アプリ起動時の全ユーザーデータの初期読み込み（loadAllClimbers）
- [x] 25. postgres_changes によるリアルタイム更新の実装
- [x] 26. Presenceをオンラインカウンター専用に変更
- [x] 27. オフライン時もアバターを山道に残す仕様の実装

## 今後の改善案
- [ ] 28. ランキング表示機能（トップ100リスト）の実装
- [ ] 29. 山頂到達時の特別演出（花火・メッセージ等）
- [ ] 30. （削除済み）PWA化

## フェーズ6: 管理機能・規模拡大対応（新規）
- [x] 31. 制限ロジックの変更（直前IDチェック廃止 → 1日1回/ID制限）
- [x] 32. ランキングUIの実装（モーダル表示、上位100件）
- [x] 33. 300人規模対応（アバター表示の間引き：※自分自身は必ず表示すること）
- [x] 34. 管理者用隠しページの作成
- [x] 35. 管理機能の実装（ユーザー削除、全リセット、段数付与）
- [x] 36. 運用マニュアル（HumanToDo）の整備

## フェーズ7: リセットトークンシステム（新規）
- [x] 37. リセットトークンによるローカルデータ同期削除機能の実装
  - [x] configテーブルへの reset_token 保存/取得ロジック
  - [x] Admin全リセット時のトークン更新
  - [x] ユーザーアクセス時のトークン比較・ローカルデータクリア
- [x] 38. 仕様書・HumanToDoへの追記